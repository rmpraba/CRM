<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<dom-module id="pre-apps">
  <template>
    <style type="text/css">
      .horizontalframe{
        display: flex;
        @apply(--layout-horizontal);
      }
      #fname,#lname,#gradeclass,#dadname,#momname,#mobile,#email,#gemail,#Guardianname,#MobileNumber,#locality,#nextyear,#midyear,#gmobile{
        --paper-input-container-label: { color: red };
      }
      paper-dropdown-menu{
        --paper-input-container-label: { color: red };
      }
      #mangender{
        color: red;
      }
      .lbl{
        @apply(--layout-horizontal);
      }
      #pgdetail{
        color: red;
      }
      .lb2,#lb2{
        @apply(--layout-horizontal);
      }
    </style>
    <div class="row enquiry-form">
      <div class="form-group-heading">
        <h4>Enquiry Detail</h4>
      </div>
      <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-4">
          <paper-input label="Date of Enquiry" id="today" readonly value="{{todaydate}}"></paper-input>
        </div>
        <div class="col-sm-3" style='margin-top: 1%;'>
          <paper-checkbox id="nextacademicyear" class="checkbox" on-change="nextyearhandler"> Next Year</paper-checkbox>
        </div>
        <div class="col-sm-3" style='margin-top: 1%;'>
          <paper-checkbox id="thismidyear" class="checkbox" on-change="midyearhandler"> Mid Term</paper-checkbox>
        </div>
      </div>
      <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-4 enquiry-input">
           <paper-input label="Academic Year" id="idacyr" readonly required error-message="needs academics year!" allowed-pattern="[a-zA-Z ]" value="{{academicyear}}"></paper-input>
        </div>
        <div class="col-sm-4">
          <paper-dropdown-menu label="Grade">
            <paper-menu  class="dropdown-content" id="newenqcardgrades" required on-iron-select="classes" valueattr="value" >
              <template  is="dom-repeat" items="{{gradeinschoolarr}}" as="grade">
                <paper-item value="{{grade.class}}">{{grade.class}}</paper-item>
              </template>
            </paper-menu>
          </paper-dropdown-menu>
        </div>
        <div class="col-sm-3 enquiry-input">
          <paper-input label="Enquiry Number" hidden value="{{enquiry_number}}"></paper-input>
        </div>
      </div>
      <div class="form-group-heading">
        <h4>Student Detail</h4>
      </div>
      <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-4">
          <paper-input label="First Name" id="idfname" required error-message="needs first name!" allowed-pattern="[a-zA-Z ]" value="{{firstname}}"></paper-input>
        </div>
        <div class="col-sm-4">
          <paper-input label="Middle Name" id="idmname" required error-message="needs middle name!" allowed-pattern="[a-zA-Z ]" value="{{middlename}}"></paper-input>
        </div>
        <div class="col-sm-4">
          <paper-input label="Last Name" id="idlname" required error-message="needs last name!" allowed-pattern="[a-zA-Z ]" value="{{lastname}}"></paper-input>
        </div>
      </div>
      <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-6 enquiry-input">
          <div class="lbl"><label>Gender </label><p id="mangender">&nbsp; *</p> </div>
          <div class="gender">
            <paper-radio-group>
              <paper-radio-button id="boyid" name="yes" on-click="maleHandler">Boy</paper-radio-button>
              <paper-radio-button id="girlid" name="no" on-click="femaleHandler">Girl</paper-radio-button>
            </paper-radio-group>
          </div>
        </div>
        <div class="col-sm-6 enquiry-input">
          <div class="lbl"><label>Sibling </label><p id="mangender">&nbsp; *</p> </div>
          <div class="gender">
            <paper-radio-group>
              <paper-radio-button id="siblingyes" name="yes" on-click="siblingyes">Yes</paper-radio-button>
              <paper-radio-button id="siblingno" name="no" on-click="siblingno">No</paper-radio-button>
            </paper-radio-group>
          </div>  
        </div>
      </div>
      <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-4" style='margin-top: -1%;'>
          <dateofbirth-datepicker showdate="{{showdate}}"></dateofbirth-datepicker>
        </div>
        <div class="col-sm-4">
          <paper-input readonly label="Age" id="age" value="{{ageofyr}}"></paper-input>
        </div>
        <div class="col-sm-4">
          <paper-dropdown-menu label="Mother Tongue">
            <paper-menu id="mothertongue" class="dropdown-content" required on-iron-select="mothertongue" valueattr="value" >
              <template  is="dom-repeat" items="{{mothertonguearr}}" as="language">
                <paper-item value="{{language.mother_tongue}}">{{language.mother_tongue}}</paper-item>
              </template>
            </paper-menu>
          </paper-dropdown-menu>
        </div>
      </div>
      <div class="form-group-heading">
         <span class="col-sm-3"><h4>Parent/Guardian Detail</h4></span><span class="col-sm-2" style="margin-left:-3%;"><p id="pgdetail">&nbsp;*</p></span>
      </div>
      <div class="list-group col-sm-12 panel-body form-category">
         <div class="col-sm-6 enquiry-input">
           <div class="gender">
             <span class="col-sm-6"><paper-checkbox  id="idparenthandler" class="checkbox" on-change="parentsHandler"><h5>Parent</h5></paper-checkbox></span>
            <span class="col-sm-6"><paper-checkbox id="idguardianhandler"  class="checkbox" on-change="gardiansHandler"><h5>Guardian</h5></paper-checkbox></span>
           </div>
        </div>
      </div>
     <div  class="list-group col-sm-12 panel-body form-category" hidden$="{{parentinfo}}">
        <div class="col-sm-6">
          <paper-input label="Father's Name" id="dadname" required error-message="needs father's name!" allowed-pattern="[a-zA-Z ]" value="{{fathername}}"></paper-input>
        </div>
        <div class="col-sm-6">
          <paper-input label="Mother's Name" id="momname" required error-message="needs mother's name!" allowed-pattern="[a-zA-Z ]" value="{{mothername}}"></paper-input>
        </div>
      </div>  
      <div class="list-group col-sm-12 panel-body form-category" hidden$="{{parentinfo}}">
        <div class="col-sm-6">
          <paper-input id="mobile" error-message="enter proper mobile no!" label="Father Mobile Number" allowed-pattern="[0-9]" maxlength="10" value="{{mob}}" on-change="verifymob"></paper-input>
        </div>
        <div class="col-sm-6">
          <paper-input id="mobile" error-message="enter proper mobile no!" label="Mother Mobile Number" allowed-pattern="[0-9]" maxlength="10" value="{{mothermob}}" on-change="verifymob"></paper-input>
        </div>
      </div>
      <div class="list-group col-sm-12 panel-body form-category" hidden$="{{parentinfo}}">
        <div class="col-sm-6">
          <gold-email-input id="email" auto-validate error-message="needs email ID!" label="Father Email" value="{{email}}"></gold-email-input>
        </div>
        <div class="col-sm-6">
          <gold-email-input id="motheremail" auto-validate error-message="needs email ID!" label="Mother Email" value="{{motheremail}}"></gold-email-input>
        </div>
      </div>
     <div class="list-group col-sm-12 panel-body form-category" hidden$="{{guardianinfo}}">
        <div class="col-sm-6">
          <paper-input label="Guardian's Name" id="Guardianname" required error-message="needs Guardian's Name!" allowed-pattern="[a-zA-Z ]" value="{{guardianname}}"></paper-input>
        </div>
        <div class="col-sm-6">
          <paper-input id="gmobile" required error-message="enter proper mobile no!" label="Mobile Number" allowed-pattern="[0-9]" maxlength="10" value="{{guardianmobile}}" on-change="gverifymob"></paper-input>
        </div>
     </div>
      <div class="list-group col-sm-12 panel-body form-category" hidden$="{{guardianinfo}}">
        <div class="col-sm-6">
          <gold-email-input id="gemail" auto-validate required error-message="needs email ID!" label="Guardian Email" value="{{guardianemail}}"></gold-email-input>
        </div>
      </div>
      <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-4 enquiry-input" hidden$="{{parentworkinfo}}">
          <div class="lbl"><label>Both are Working? </label><p id="mangender">&nbsp; *</p> </div>
          <div class="gender">
            <paper-radio-group>
              <paper-radio-button id="parentworkyes" name="yes" on-click="parentworkyes">Yes</paper-radio-button>
              <paper-radio-button  id="parentworkno" name="no" on-click="parentworkno">No</paper-radio-button>
            </paper-radio-group>
          </div>
        </div>
        <div class="col-sm-4 enquiry-input" hidden$="{{guardianworkinfo}}">
          <div class="lbl"><label>Guardian is Working? </label><p id="mangender">&nbsp; *</p> </div>
          <div class="gender">
            <paper-radio-group>
              <paper-radio-button id="guardianworkyes" name="yes" on-click="guardianworkyes">Yes</paper-radio-button>
              <paper-radio-button  id="guardianworkno" name="no" on-click="guardianworkno">No</paper-radio-button>
            </paper-radio-group>
          </div>
        </div>
        <div class="col-sm-4 enquiry-input" hidden$="{{guardianoccupation}}">
          <paper-dropdown-menu label="Guardian's Profession" style="margin-top: 3%;">
            <paper-menu class="dropdown-content"  class="dropdown-content" id="idguardianoccupation" on-iron-select="guardianoccupationselector" >
              <template  is="dom-repeat" items="{{professionarr}}" as="item">
                <paper-item>{{item.profession}}</paper-item>
              </template>
            </paper-menu>
          </paper-dropdown-menu>
        </div>
        <div  class="col-sm-4 enquiry-input" hidden$="{{hideoccupation}}">
          <div class="lbl"><label>Choose Who is working</label><p id="mangender">&nbsp; *</p> </div>
          <div class="gender">
              <paper-radio-group>
                <paper-radio-button id="father" name="yes" on-click="father">Father</paper-radio-button>
                <paper-radio-button id="mother" name="no" on-click="mother">Mother</paper-radio-button>
              </paper-radio-group>
            </div>
        </div>
        <div class="col-sm-4 enquiry-input" hidden$="{{dadoccupation}}">
          <paper-dropdown-menu label="Father's Profession" style="margin-top: 3%;">
            <paper-menu class="dropdown-content"  class="dropdown-content" id="iddadoccupation" on-iron-select="dadoccupationselector" >
              <template  is="dom-repeat" items="{{professionarr}}" as="item">
                <paper-item>{{item.profession}}</paper-item>
              </template>
            </paper-menu>
          </paper-dropdown-menu>
        </div>
        <div class="col-sm-4 enquiry-input" hidden$="{{motheroccupation}}">
          <paper-dropdown-menu label="Mother's Profession" style="margin-top: 3%;">
            <paper-menu class="dropdown-content"  class="dropdown-content" id="idmotheroccupation" on-iron-select="motheroccupationselector" >
              <template  is="dom-repeat" items="{{professionarr}}" as="item">
                <paper-item>{{item.profession}}</paper-item>
              </template>
            </paper-menu>
          </paper-dropdown-menu>
        </div>
      </div>
      <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-6">
          <paper-input  id="idlocality" required error-message="needs locality!" label="Enter location/Landmark" is="" value="{{textvalue}}" on-keydown="FnInputChanged"></paper-input>
          <paper-listbox class="dropdown-content" id="iditemlist" on-iron-select="Fnselected" valueattr="value">
            <template is="dom-repeat" items="{{itemArray}}" as="item">
              <paper-item value="{{item.itemid}}">{{item.itemdes}}</paper-item>
            </template>
          </paper-listbox>
        </div>
        <div class="col-sm-4" style='margin-top: -1%;'>
          <paper-dropdown-menu label="Enquiry Source" style="margin-top: 3%;">
            <paper-menu class="dropdown-content"  class="dropdown-content" id="enquiry-source" on-iron-select="source" >
              <template  is="dom-repeat" items="{{sourcearr}}" as="item">
                <paper-item>{{item.source}}</paper-item>
              </template>
            </paper-menu>
          </paper-dropdown-menu>
        </div>
      </div>  
      <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-4" id="sibname">
          <paper-input  label="Names of sibling" value="{{siblingname}}"></paper-input>
        </div>
        <div class="col-sm-6" id="sibdetail">
          <paper-input  label="Grade of sibling" value="{{siblingdetails}}"></paper-input>
        </div>
        <div class="col-sm-6" id="referrer">
          <paper-input  error-message="needs referrer!" label="Enter referrer name.." is="" value="{{referrername}}" on-keydown="FnInputChangedz"></paper-input>
          <paper-listbox class="dropdown-content" id="iditemlistz" on-iron-select="Fnselectedz" valueattr="value">
            <template is="dom-repeat" items="{{itemArrayz}}" as="item">
              <paper-item >{{item.itemdesz}}</paper-item>
            </template>
          </paper-listbox>
        </div> 
        <div class="col-sm-4">
          <paper-dropdown-menu label="Attended By" style="margin-top: 3%;">
            <paper-menu class="dropdown-content" on-iron-select="attendedby" id="idrmnames">
              <template  is="dom-repeat" items="{{counsellor}}" as="name">
                <paper-item value="{{name.counsellor_name}}">{{name.counsellor_id}}</paper-item>
              </template>
            </paper-menu>
          </paper-dropdown-menu>
        </div> 
      </div>   
      <!-- <div class="list-group col-sm-12 panel-body form-category">
        <div class="col-sm-6 enquiry-input" style='margin-top: 0.5%;'>
          <template  is="dom-repeat" items="{{discountarr}}" as="view">
            <special-discount-card code="{{view.id}}" discountname="{{view.discount_type_name}}"></special-discount-card>
          </template>
        </div>  
      </div>  -->
    </div>
      <div class="col-md-12 form-button">
        <paper-button class="btn btn-primary" on-click="getenquirynumber">SUBMIT</paper-button>
      </div>
    <pre-apps-service id='preapps'></pre-apps-service>
  </template>
  <script>
  (function() {
    'use strict';

    var enrolltype;
    var yr1;
    var yr2;
    var yearsxz;
    var todaydat;
    var dobdate;
    var grade;
    var paga;
    var currentdate;
    var namearr=[];
    var namearrz=[];
    var enquiysource;
    var havesibling;
    var gender;
    var mothertonguelanguage;
    var attenedcounsellorname;
    var dadoccupationinfo;
    var motheroccupationinfo;
    var guardianoccupationinfo;
    var bothparentswork;
    var guardianwork;
    var fatherworkdet;
    var motherworkdet;
    var parent_or_guardian_work;
    var yearAge ;
    Polymer({
      is: 'pre-apps',

    ready:function(){
      this.$.idparenthandler.checked=true;
      this.guardianinfo=true;
      this.$.preapps.getclasses();
      this.$.preapps.getdiscounts();
      this.$.preapps.getenquirysource();
      this.$.preapps.getcounsellorattendedby();
      this.$.preapps.getlocation();
      this.$.preapps.getmothertongue();
      this.$.preapps.getprofession();
      this.$.sibname.hidden=true;
      this.$.sibdetail.hidden=true;
      this.$.referrer.hidden=true;
      this.hideoccupation = true;
      this.dadoccupation = true;
      this.motheroccupation = true;
      this.guardianoccupation = true;
      this.guardianworkinfo = true;
      var dt=new Date();
      todaydat=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
      sessionStorage.setItem("todaydate",todaydat);
      this.todaydate=todaydat;
      currentdate=dt.getFullYear()+"-"+(dt.getMonth()+1)+"-"+dt.getDate();
      paga="parent";
      /*this.$.service.getdiscounts();
      this.$.service.getrmnamelist();
      */
    },
    midyearhandler:function(e){
      if(e.target.checked==true){
        document.getElementById("nextacademicyear").checked=false;
        enrolltype="midyear";
        var dt=new Date();
        var month=dt.getMonth()+1;
        yr1=(dt.getFullYear())-2000;
        yr2=(dt.getFullYear()+1)-2000;
        yearsxz='AY-'+dt.getFullYear()+'-'+(dt.getFullYear()+1);
        this.academicyear=yearsxz;
      } else {
        enrolltype=null;
        this.academicyear="";
      } 
    },
    callnextyearhandler:function(e){
      this.$.nextacademicyear.checked = true;
      enrolltype="fullyear";
      var dt=new Date();
      yr1=(dt.getFullYear()+1)-2000;
      yr2=(dt.getFullYear()+2)-2000;
      yearsxz='AY-'+(dt.getFullYear()+1)+'-'+(dt.getFullYear()+2);
      this.academicyear=yearsxz;
    },
    nextyearhandler:function(e){
      if(e.target.checked==true){
        document.getElementById("thismidyear").checked=false;
        enrolltype="fullyear";
        var dt=new Date();
        yr1=(dt.getFullYear()+1)-2000;
        yr2=(dt.getFullYear()+2)-2000;
        yearsxz='AY-'+(dt.getFullYear()+1)+'-'+(dt.getFullYear()+2);
        this.academicyear=yearsxz;
      }else{
        enrolltype=null;
        this.academicyear="";
      }
    },  
    classes:function(e){
      grade=(e.target.selectedItem.textContent).trim();
    },
    dateclear:function(){
      alert("Select DOB properly, it cannot be future date");
    },
    getdate:function(dates){
      var dt1=new Date(dates);
      dobdate=dates;
      var dt=new Date();
      var pr_month = dt.getMonth()+1;
      var bt_month = dt1.getMonth()+1;
      var diffmonth = parseInt(pr_month-bt_month);
      var pr_year=dt.getFullYear();
      var bt_year=dt1.getFullYear();
      var diff=parseInt(pr_year-bt_year);
      var now = new Date();
      var today = new Date(now.getYear(),now.getMonth(),now.getDate());

      var yearNow = now.getYear();
      var monthNow = now.getMonth();
      var dateNow = now.getDate();

      var dob = new Date(dates.substring(6,10),
                         dates.substring(0,2)-1,                   
                         dates.substring(3,5)                  
                         );

      var yearDob = dob.getYear();
      var monthDob = dob.getMonth();
      var dateDob = dob.getDate();
      var age = {};
      var ageString = "";
      var yearString = "";
      var monthString = "";
      var dayString = "";


      yearAge = yearNow - yearDob;

      if (monthNow >= monthDob)
        var monthAge = monthNow - monthDob;
      else {
        yearAge--;
        var monthAge = 12 + monthNow -monthDob;
      }

      if (dateNow >= dateDob)
        var dateAge = dateNow - dateDob;
      else {
        monthAge--;
        var dateAge = 31 + dateNow - dateDob;

        if (monthAge < 0) {
          monthAge = 11;
          yearAge--;
        }
      }

      age = {
          years: yearAge,
          months: monthAge,
          days: dateAge
          };

      if ( age.years > 1 ) yearString = " years";
      else yearString = " year";
      if ( age.months> 1 ) monthString = " months";
      else monthString = " month";
      if ( age.days > 1 ) dayString = " days";
      else dayString = " day";


      if ( (age.years > 0) && (age.months > 0) && (age.days > 0) )
        ageString = age.years + yearString + ", " + age.months + monthString;
      else if ( (age.years > 0) && (age.months == 0) && (age.days == 0) )
        ageString = age.years + yearString;
      else if ( (age.years > 0) && (age.months > 0) && (age.days == 0) )
        ageString = age.years + yearString + ", " + age.months + monthString;
      else if ( (age.years == 0) && (age.months > 0) && (age.days > 0) )
        ageString = age.months + monthString;
      else if ( (age.years > 0) && (age.months == 0) && (age.days > 0) )
        ageString = age.years + yearString;
      else if ( (age.years == 0) && (age.months > 0) && (age.days == 0) )
        ageString = age.months + monthString;
      else ageString = "Oops! Could not calculate age!";
      this.ageofyr=ageString;
      this.$.preapps.verifyage(grade,age.years);
    },
    gardiansHandler:function(e){
      if(e.target.checked==true){
        document.getElementById("idparenthandler").checked=false;
        paga="guardian";
        this.guardianinfo=false;
        this.parentinfo=true;
        this.hideoccupation = true;
        this.parentworkinfo = true;
        this.guardianworkinfo = false;
        this.motheroccupation = true;
        this.dadoccupation = true;
        this.fathername="";
        this.mothername="";
        this.mob="";
        this.email="";
      } else {
        paga=null;
        this.guardianname="";
        this.guardianmobile="";
        this.guardianemail="";
      }
    },
    parentsHandler:function(e){
      if(e.target.checked==true){
        document.getElementById("idguardianhandler").checked=false;
        this.guardianinfo=true;
        this.parentinfo=false;
        this.parentworkinfo = false;
        this.guardianworkinfo = true;
        this.guardianoccupation = true;
        paga="parent";
        this.guardianname="";
        this.guardianmobile="";
        this.guardianemail="";
        //alert(gender);
      } else {
        paga=null;
        this.fathername="";
        this.mothername="";
        this.mob="";
        this.email="";
      }
    },
    source:function(e){
      enquiysource=(e.target.selectedItem.textContent).trim();
      if(enquiysource=="Siblings"){
        this.$.sibname.hidden=false;
        this.$.sibdetail.hidden=false;
        this.$.referrer.hidden=true;
      } else if(enquiysource=="Referrer") {
        this.$.referrer.hidden=false;
        this.$.sibname.hidden=true;
        this.$.sibdetail.hidden=true;
        this.$.preapps.getreferrername();
      } else {
        this.$.sibname.hidden=true;
        this.$.sibdetail.hidden=true;
        this.$.referrer.hidden=true;
      }
    },
    Fnlistboxz:function(nameitem){
       namearrz=nameitem;
    },
    FnInputChangedz:function(e){
          this.$.iditemlistz.hidden=false;
          if(e.keyCode==13|| e.keyCode==40)
            this.querySelector('paper-listbox').focus();

          var arr=[];
          arr.push({"itemdesz":"-----Select-----"});
          this.querySelector('paper-listbox').style.visibility='visible';
          if(e.keyCode==8){
            this.itemflagz="true";
            this.itemvalz="";
            //alert('yes');
            var len=(this.referrername).length;
            if(len<=1){
              this.querySelector('paper-listbox').style.visibility='hidden';
              this.itemArrayz="";
              this.itemvalz="";
            }
            if(len>1){
              this.querySelector('paper-listbox').style.visibility='visible';
              var backsubval=(((this.referrername).substring(0,(len-1))).trim()).toUpperCase();
              for(var i=0;i<namearrz.length;i++)
              {
                var subval=((namearrz[i].listname).trim()).substring(0,backsubval.length);
                if((namearrz[i].listname).toUpperCase().indexOf((this.refferername).toUpperCase())!=-1)
                {
                  var obj={"itemdesz":""};
                  obj.itemdesz=namearrz[i].listname;
                  arr.push(obj);
                }
              }
              this.itemArrayz=arr;
            }
          }
          if(e.keyCode!=8&& e.keyCode!=16&& e.keyCode!=13 && e.keyCode!=38&&e.keyCode!=40&&e.keyCode!=37&&e.keyCode!=39){
            if(this.itemflagz=="true") {
              this.itemvalz = (this.referrername).toUpperCase()+String.fromCharCode((e.keyCode)).toUpperCase();
              this.itemflagz="false";
            }
            else
            this.itemvalz = this.referrername +String.fromCharCode((e.keyCode));
            if(this.itemvalz.length>0)
            {
              for(var i=0;i<namearrz.length;i++){
                var subval=((namearrz[i].listname).trim()).substring(0,this.itemvalz.length);
                if((namearrz[i].listname).toUpperCase().indexOf((this.itemvalz).toUpperCase())!=-1)
                {
                  var obj={"itemdesz":""};
                  obj.itemdesz=namearrz[i].listname;
                  arr.push(obj);
                }
              }
              if(arr.length>0)
                this.itemArrayz=arr;
              else {
                var obj={"itemdesz":""};
                  obj.itemdesz="NO Item Found";
                  arr.push(obj);
                this.itemArrayz=arr;
              }
            }
          }

    },
    Fnselectedz:function(e){
      //alert('s');
      this.querySelector('paper-listbox').style.visibility='hidden';
      this.referrername = e.target.selectedItem.textContent.trim();
      this.itemArrayz=[];
      document.querySelector('#iditemlist').selected=-1;
      this.$.iditemlistz.hidden=true;
    },
    attendedby:function(e){
      attenedcounsellorname = e.target.selectedItem.value;
    },
    autocompletename(nameitem){
      namearr=nameitem;
    },
    FnInputChanged:function(e){
          this.$.iditemlist.hidden=false;
          if(e.keyCode==13|| e.keyCode==40)
            this.querySelector('paper-listbox').focus();
          var arr=[];
          arr.push({"itemdes":"-----Select-----"});
          this.querySelector('paper-listbox').style.visibility='visible';
          if(e.keyCode==8){
            this.itemflag="true";
            this.itemval="";
            //alert('yes');
            var len=(this.textvalue).length;
            if(len<=1){
              this.querySelector('paper-listbox').style.visibility='hidden';
              this.itemArray="";
              this.itemval="";
            }
            if(len>1){
              this.querySelector('paper-listbox').style.visibility='visible';
              var backsubval=(((this.textvalue).substring(0,(len-1))).trim()).toUpperCase();
              for(var i=0;i<namearr.length;i++)
              {
                var subval=((namearr[i].habitat_name).trim()).substring(0,backsubval.length);
                if((subval).toUpperCase()==(backsubval).toUpperCase())
                {
                  var obj={"itemdes":"","itemid":""};
                  obj.itemdes=namearr[i].habitat_name;
                  obj.itemid=namearr[i].habitat_id;
                  arr.push(obj);
                }
              }
              this.itemArray=arr;
            }
          }
          if(e.keyCode!=8&& e.keyCode!=16&& e.keyCode!=13 && e.keyCode!=38&&e.keyCode!=40&&e.keyCode!=37&&e.keyCode!=39){
            if(this.itemflag=="true") {
              this.itemval = (this.textvalue).toUpperCase()+String.fromCharCode((e.keyCode)).toUpperCase();
              this.itemflag="false";
            }
            else
            this.itemval = this.textvalue +String.fromCharCode((e.keyCode));
            if(this.itemval.length>0)
            {
              for(var i=0;i<namearr.length;i++){
                var subval=((namearr[i].habitat_name).trim()).substring(0,this.itemval.length);
                if((subval).toUpperCase()==(this.itemval).toUpperCase()){
                  var obj={"itemdes":"","itemid":""};
                  obj.itemdes=namearr[i].habitat_name;
                  obj.itemid=namearr[i].habitat_id;
                  arr.push(obj);
                }
              }
              if(arr.length>0)
                this.itemArray=arr;
              else {
                var obj={"itemdes":"","itemid":""};
                  obj.itemdes=namearr[i].habitat_name;
                  obj.itemid=namearr[i].habitat_id;
                  arr.push(obj);
                this.itemArray=arr;
              }
            }
          }
    },
    Fnselected:function(e){
      //alert('s');
      this.querySelector('paper-listbox').style.visibility='hidden';
      this.textvalue = e.target.selectedItem.textContent.trim();
      this.itemArray=[];
      document.querySelector('#iditemlist').selected=-1;
      this.$.iditemlist.hidden=true;
    },
    siblingyes:function(){
      havesibling = "yes";
    },
    siblingno:function(){
      havesibling = "no";
    },
    parentworkyes:function(){
      bothparentswork = "yes";
      this.hideoccupation = true;
      this.dadoccupation = false;
      this.motheroccupation = false;
    },
    parentworkno:function(){
      bothparentswork = "no";
      this.hideoccupation = false;
      this.dadoccupation = true;
      this.motheroccupation = true;
    },
    father:function(){
      this.dadoccupation = false;
      this.motheroccupation = true;
      fatherworkdet = "yes";
      motherworkdet = "no";
    },
    mother:function(){
      this.dadoccupation = true;
      fatherworkdet = "no";
      motherworkdet = "yes";
      this.motheroccupation = false;
    },
    maleHandler:function(){
      gender = "boy";
    },
    femaleHandler:function(){
      gender = "girl";
    },
    mothertongue:function(e){
      mothertonguelanguage = e.target.selectedItem.value
    },
    dadoccupationselector:function(e){
      dadoccupationinfo = (e.target.selectedItem.textContent).trim();
    }, 
    motheroccupationselector:function(e){
      motheroccupationinfo = (e.target.selectedItem.textContent).trim();
    },
    getenquirynumber:function(){
      if(guardianwork == "yes"){
          parent_or_guardian_work = "guardian";
      } else {
        if(bothparentswork == "yes"){
          parent_or_guardian_work = "parents";
        } else {
          if(fatherworkdet == "yes"){
            parent_or_guardian_work = "father";
          } else {
            parent_or_guardian_work = "mother";
          }
        }
      }
      this.$.preapps.getenquiryno();
    },
    guardianworkyes:function(){
      this.guardianoccupation = false;
      guardianwork = "yes";
    },
    guardianworkno:function(){
      this.guardianoccupation = true;
      guardianwork = "no";
    },
    guardianoccupationselector:function(e){
      guardianoccupationinfo = (e.target.selectedItem.textContent).trim();
    },
    complete:function(){
      if(paga=="guardian"){
        if(this.todaydate == ""|| this.firstname==""||this.textvalue==""||this.guardianname==""||this.guardianemail==""||this.guardianmobile==""||this.academicyear=='' || this.ageofyr ==""){
          // alert('1');
          this.$.today.validate();
          this.$.idfname.validate();
          this.$.idlocality.validate();
          this.$.guardianname.validate();
          this.$.gmobile.validate();
          this.$.guardianemail.validate();
          this.$.idacyr.validate();
          this.$.age.validate();
        } else if(grade==null){
          // alert('4');
          alert('Select the grade your seeking for admission');
        } else if(gender==null){
          // alert('5');
          alert('Select the gender of the student');
        } else if(dobdate==null){
          // alert('6');
          alert('Select date of birth properly')
        } else if(this.textvalue==null||this.textvalue==""){
          // alert('7');
          alert('Select the Location');
        } else if(enrolltype==null){
           alert('Select the Academics Year Type');
        } else if(enquiysource == null){
            alert("Select Enquiry Source");
        } else if(attenedcounsellorname == null){
            alert("Select Counsellor");
        }else if(mothertonguelanguage == null){
            alert("Select Mother Tongue");
        } else if(havesibling == null){
            alert("Select the student having sibling or not");
        } else if(guardianwork == null){
          alert("Select Guardian Work");
        } else {
          this.getvalues();
        }
      } else if(paga=="parent") {
        if(this.todaydate == ""|| this.firstname==""||this.textvalue==""||this.fathername==""||this.mothername==""||this.mob==""||this.email==""||this.academicyear==""  || this.ageofyr ==""){
          alert("1");
          this.$.today.validate();
          this.$.idfname.validate();
          this.$.idlocality.validate();
          this.$.dadname.validate();
          this.$.momname.validate();
          this.$.mobile.validate();
          this.$.email.validate();
          this.$.idacyr.validate();
          this.$.age.validate();
        } else if(grade==null) {
          alert('Select the grade your seeking for admission');
        } else if(gender==null){
          alert('Select the gender of the student');
        } else if(dobdate==null){
          alert('Select date of birth properly')
        } else if(this.textvalue==null||this.textvalue==""){
          alert('Select the Location');
        } else if(enrolltype==null){
           alert('Select the Academic Year Type');
        }  else if(enquiysource == null){
            alert("Select Enquiry Source");
        } else if(attenedcounsellorname == null){
            alert("Select Counsellor");
        } else if(bothparentswork == null){
            alert("Check Both Parent are working or not");
        } else if(mothertonguelanguage == null){
            alert("Select Mother Tongue");
        } else if(havesibling == null){
            alert("Select the student having sibling or not");
        } else{
          this.getvalues();
        }
      } else {
        alert("Error");
      }
    },
    getvalues:function(){
      alert("hi");
      this.$.preapps.submitenqdetails(currentdate,enrolltype,this.academicyear,grade,this.firstname,this.middlename,this.lastname,gender,havesibling,this.ageofyr,dobdate,mothertonguelanguage,this.fathername,this.mothername,this.mob,this.mothermob,this.email,this.motheremail,this.guardianname,this.guardianmobile,this.guardianemail,dadoccupationinfo,motheroccupationinfo,this.textvalue,enquiysource,attenedcounsellorname,this.siblingname,this.siblingdetails,this.referrername,this.enquiry_number,guardianoccupationinfo,parent_or_guardian_work);
    },
    FnClear:function(){
      this.callnextyearhandler();
      paga="parent";
      this.firstname = "";
      this.middlename = "";
      this.lastname = "";
      this.siblingname = "";
      this.siblingdetails = "";
      this.ageofyr = "";
      document.querySelector('#newenqcardgrades').selected=-1;
      document.querySelector('#mothertongue').selected=-1;
      document.querySelector('#iddadoccupation').selected=-1;
      document.querySelector('#idmotheroccupation').selected=-1;
      this.textvalue = "";
      this.referrername="";
      document.querySelector('#idrmnames').selected=-1;
      document.querySelector('#enquiry-source').selected=-1;
      document.getElementById("nextacademicyear").checked=false;
      document.getElementById("thismidyear").checked=false;
      this.academicyear = "";
      this.fathername = "";
      this.mothername = "";
      this.mob = "";
      this.mothermob = "";
      this.email = "";
      this.motheremail = "";
      this.guardianname = "";
      this.guardianmobile ="";
      this.guardianemail = "";
      this.$.parentworkyes.checked = false;
      this.$.parentworkno.checked = false;
      this.$.father.checked = false;
      this.$.mother.checked = false;
      this.$.siblingyes.checked = false;
      this.$.siblingno.checked = false;
      this.$.boyid.checked = false;
      this.$.girlid.checked = false;
      this.$.idparenthandler.checked = true;
      this.$.idguardianhandler.checked = false;
      this.parentinfo = false;
      this.hideoccupation = true;
      this.dadoccupation = true;
      this.motheroccupation = true;
      this.guardianinfo=true;
      this.$.sibname.hidden=true;
      this.$.sibdetail.hidden=true;
      this.$.referrer.hidden=true;
      this.guardianoccupation = true;
      this.guardianworkinfo = true;
    },
    });
  })();
  </script>
</dom-module>
